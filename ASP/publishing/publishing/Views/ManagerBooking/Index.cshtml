@model IEnumerable<publishing.Models.Booking>

@{
    ViewData["Title"] = "Управление заказами";
}
<h1 style="margin-bottom: 10px;">Управление заказами</h1>


<table class="table table-bordered table-hover" id="tabl">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Id)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Start)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Status)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Cost)
        </th>
        <th>
            Действие
        </th>

    </tr>
    @foreach (var item in Model)
    {
        @if (item.Status != "Выполнен")
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Id)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Start)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Status)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Cost)
                </td>
                <td>

                    <form asp-action="ChooseEmployees" id="ch">
                        <div>
                            <input type="hidden" name="bookingId" value="@item.Id" />
                            <input type="hidden" name="bookingStatus" value="@item.Status">
                            <input type="submit" value="Выбрать" class="btn btn-primary" onclick="Confirm(this)"/>
                        </div>
                    </form>
                </td>
            </tr>
        }
    }
</table>

@section Scripts
    {
    <script>
        function  Confirm(element) {
            let table = document.querySelector('#tabl');
            var status = table.rows[element.closest('tr').rowIndex].cells[2].innerHTML;
;
            if (status.trim() == "Выполняется") {
                if(!confirm("Вы подтверждаете выполнение заказа?")){
                    event.preventDefault();
                }
            }
        }

    </script>
}


